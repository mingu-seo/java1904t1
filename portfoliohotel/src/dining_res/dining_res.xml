<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="dining_res">

	<typeAlias alias="dining_resvo" type="dining_res.Dining_resVO" />

	<select id="count" parameterClass="dining_resvo" resultClass="Integer">
		select count(*) from dining_res
	</select>

	<select id="list" parameterClass="dining_resvo" resultClass="dining_resvo">
		select no, member_name, dining_name, d_day, d_time, adult, kid, guest_kname, guest_ename
		, guest_tel, guest_email, regdate from dining_res
		ORDER BY
		<isEqual property="orderCond" compareValue="">
			regdate DESC
		</isEqual>
		<isNotEqual property="orderCond" compareValue="">
			<isEqual property="orderCond" compareValue="regdate_desc">
				regdate DESC
			</isEqual>
			<isEqual property="orderCond" compareValue="regdate_asc">
				regdate ASC
			</isEqual>
		</isNotEqual>
		LIMIT $startPageNo$, $pageRows$
	</select>
	
	<insert id="insert" parameterClass="dining_resvo">
		insert into dining_res (
		d_day, d_time, adult, kid, guest_kname, guest_ename, guest_tel, guest_email, regdate, price) 
		values (
		#d_day#, #d_time#, #adult#, #kid#, #guest_kname#, #guest_ename#, #guest_tel#, #guest_email#, now(), #price#)
		<selectKey keyProperty="no" resultClass="Integer">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	
	<update id="update" parameterClass="dining_resvo">
        update dining_res set
        	d_day=#d_day#, d_time=#d_time#, adult=#adult#, kid=#kid#, guest_kname=#guest_kname#,
        	guest_ename=#guest_ename#, guest_tel=#guest_tel#, guest_email=#guest_email#
        where no=#no#
    </update>
    
    <select id="read" parameterClass="Integer" resultClass="dining_resvo">
		select no, d_day, member_name, guest_tel, dining_name, adult, kid, regdate, price
		from dining_res where no=#no#
	</select>
    
    <delete id="delete" parameterClass="Integer">
		delete from dining_res where no=#no#
	</delete>

</sqlMap>







